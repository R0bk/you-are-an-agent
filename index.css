/* Global CRT-ish overlays (used by `components/CRTEffectOverlay.tsx`) */

@keyframes crt-flicker {
    0% { opacity: 0.35; }
    5% { opacity: 0.25; }
    10% { opacity: 0.45; }
    15% { opacity: 0.30; }
    20% { opacity: 0.50; }
    100% { opacity: 0.35; }
  }

  /* Safari filter compositor keepalive: continuous animation prevents Safari from
     caching the filtered layer as a static texture. The transform change is imperceptible. */
  @keyframes safari-filter-keepalive {
    0% { transform: translateZ(0.01px); }
    50% { transform: translateZ(0.02px); }
    100% { transform: translateZ(0.01px); }
  }

  .safari-filter-keepalive {
    animation: safari-filter-keepalive 0.5s linear infinite;
  }
  
  .crt-vignette {
    background: radial-gradient(
      circle at center,
      rgba(0, 0, 0, 0) 0%,
      rgba(0, 0, 0, 0.25) 60%,
      rgba(0, 0, 0, 0.65) 100%
    );
  }
  
  .crt-scanlines {
    background: repeating-linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.03) 0px,
      rgba(255, 255, 255, 0.03) 1px,
      rgba(0, 0, 0, 0.02) 2px,
      rgba(0, 0, 0, 0.02) 4px
    );
    opacity: 0.55;
    mix-blend-mode: overlay;
  }
  
  .crt-flicker {
    background: rgba(255, 255, 255, 0.03);
    animation: crt-flicker 7s infinite;
    mix-blend-mode: overlay;
  }
  
  .crt-title-glow {
    background:
      radial-gradient(circle at 50% 40%, rgba(34, 197, 94, 0.20), rgba(0, 0, 0, 0) 60%),
      radial-gradient(circle at 50% 60%, rgba(255, 255, 255, 0.06), rgba(0, 0, 0, 0) 55%);
    filter: blur(18px);
  }
  
  /* DOM-level curvature approximation (keeps interactivity; not a true pixel warp).

     NOTE: Previously used CSS 3D transforms (perspective, rotateX, scale) but Safari
     has compositor issues with 3D transforms on containers with rapidly updating content
     (typewriter animations, scrolling). The transform would apply "late" causing flicker.

     Now uses border-radius only for a subtle curved-corner effect. The WebGL overlay
     (CRTEffectOverlayWebGL) handles the actual barrel distortion visually. */
  .crt-curvature {
    position: relative;
    --crt-curv: calc(var(--crt-curvature, 0) * 10);
    border-radius: calc(var(--crt-curv) * 18px);
    overflow: hidden; /* Clip content to the rounded corners */
  }

  .crt-curvature::before {
    /* Disabled: this "glass gradient" reads as a weird wash on large containers. */
    content: none;
  }
  
  /* “Feels applied” approximation: CSS postprocess on the actual DOM content.
     This is not a true pixel warp, but it sells the effect (slight blur + chromatic fringe). */
  .crt-content-postprocess {
    --crt-aberr: 0px;
    --crt-blur: 0px;
    --crt-contrast: 1;
    --crt-sat: 1;
    --crt-bright: 1;
  
    filter:
      drop-shadow(calc(var(--crt-aberr) * 1) 0 0 rgba(255, 60, 60, 0.18))
      drop-shadow(calc(var(--crt-aberr) * -1) 0 0 rgba(60, 200, 255, 0.14))
      blur(var(--crt-blur))
      contrast(var(--crt-contrast))
      saturate(var(--crt-sat))
      brightness(var(--crt-bright));
  }
  
  /* Shell wrapper that adds "applied to content" overlays and a subtle curved-corner effect.

     NOTE: Previously used CSS 3D transforms but removed due to Safari compositor issues
     (same as .crt-curvature above). WebGL overlay handles the visual distortion. */
  .crt-content-shell {
    position: relative;
    overflow: hidden;

    /* 0..1 */
    --crt-warp: 0;
    --crt-vig: 0.4;
    --crt-scan: 0.25;

    border-radius: calc(var(--crt-warp) * 18px);
  }
  
  
  .crt-content-shell::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: repeating-linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.03) 0px,
      rgba(255, 255, 255, 0.03) 1px,
      rgba(0, 0, 0, 0.02) 2px,
      rgba(0, 0, 0, 0.02) 4px
    );
    opacity: clamp(0, var(--crt-scan), 1);
    /* Screen keeps scanlines as a light-only effect; overlay can darken heavily on black UIs. */
    mix-blend-mode: screen;
    z-index: 3;
  }
  
  /* Prevent page-level scrollbars; scrolling should be handled by inner panels. */
  html,
  body,
  #root {
    overflow-x: hidden;
    overflow-y: hidden;
    /* Ensure nothing exceeds viewport on mobile - 100vw can include scrollbar width */
    max-width: 100%;
    width: 100%;
  }

  /* Prevent touch-based horizontal scrolling on mobile */
  html {
    overscroll-behavior-x: none;
  }

  /* Terminal-style scrollbar */
  ::-webkit-scrollbar {
    width: 16px; /* Large hitbox */
  }
  ::-webkit-scrollbar-track {
    background: transparent;
  }
  ::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.4);
    border-radius: 0;
    /* Visual width is 9px, centered in 16px hitbox */
    border-left: 4px solid transparent;
    border-right: 3px solid transparent;
    background-clip: padding-box;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.6);
    background-clip: padding-box;
  }
  /* Firefox */
  * {
    scrollbar-width: auto;
    scrollbar-color: rgba(255, 255, 255, 0.4) transparent;
  }

  /* Terminal prompt box canvas font.
     Uses a "boring" system monospace stack instead of JetBrains Mono
     because box-drawing glyphs can visually misalign at some sizes. */
  .terminal-canvas-font {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  }

  /* CRT scroll area fade masks - content fades at top/bottom edges */
  .crt-scroll-fade {
    --fade-size: 48px;
    mask-image: linear-gradient(
      to bottom,
      transparent 0,
      black var(--fade-size),
      black calc(100% - var(--fade-size)),
      transparent 100%
    );
    -webkit-mask-image: linear-gradient(
      to bottom,
      transparent 0,
      black var(--fade-size),
      black calc(100% - var(--fade-size)),
      transparent 100%
    );
  }

  
  
  