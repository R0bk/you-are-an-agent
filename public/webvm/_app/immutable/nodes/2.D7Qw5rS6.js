import{s as Xe,n as He,b as ct,o as hr}from"../chunks/B2QSKqcC.js";import{S as Ve,i as Ke,d as L,x as fe,y as H,b as ze,c as R,w as C,e as D,f as z,h as oe,z as _e,j as T,l as ce,q as xt,t as Et,a as kt,u as At,v as Pt,r as Mt}from"../chunks/C6TUdmF6.js";import{_ as he}from"../chunks/CmsKOCeN.js";import{w as U}from"../chunks/8N5YGjy-.js";const pr=!0,Dn=Object.freeze(Object.defineProperty({__proto__:null,prerender:pr},Symbol.toStringTag,{value:"Module"})),Rt=U(!1),It=U(!1),mr=U(0),gr=U(0);function wr(r){let e,t,n,s,i,a="CPU",o,f,c,h,p,S="DISK";return{c(){e=T("div"),t=T("div"),n=T("div"),s=ce(),i=T("span"),i.textContent=a,o=ce(),f=T("div"),c=T("div"),h=ce(),p=T("span"),p.textContent=S,this.h()},l(b){e=D(b,"DIV",{class:!0});var _=z(e);t=D(_,"DIV",{class:!0});var j=z(t);n=D(j,"DIV",{class:!0,style:!0}),z(n).forEach(L),s=oe(j),i=D(j,"SPAN",{class:!0,"data-svelte-h":!0}),_e(i)!=="svelte-1lxtmo4"&&(i.textContent=a),j.forEach(L),o=oe(_),f=D(_,"DIV",{class:!0});var O=z(f);c=D(O,"DIV",{class:!0,style:!0}),z(c).forEach(L),h=oe(O),p=D(O,"SPAN",{class:!0,"data-svelte-h":!0}),_e(p)!=="svelte-rwmr5j"&&(p.textContent=S),O.forEach(L),_.forEach(L),this.h()},h(){C(n,"class","w-2 h-2 rounded-full transition-all duration-150"),fe(n,"box-shadow",r[0]?"0 0 8px rgba(34, 197, 94, 0.8)":"none"),H(n,"bg-green-500",r[0]),H(n,"bg-gray-700",!r[0]),C(i,"class","font-mono"),C(t,"class","flex items-center gap-1 text-xs text-gray-400"),C(c,"class","w-2 h-2 rounded-full transition-all duration-150"),fe(c,"box-shadow",r[1]?"0 0 8px rgba(59, 130, 246, 0.8)":"none"),H(c,"bg-blue-500",r[1]),H(c,"bg-gray-700",!r[1]),C(p,"class","font-mono"),C(f,"class","flex items-center gap-1 text-xs text-gray-400"),C(e,"class","fixed top-2 right-2 flex gap-2 z-50")},m(b,_){ze(b,e,_),R(e,t),R(t,n),R(t,s),R(t,i),R(e,o),R(e,f),R(f,c),R(f,h),R(f,p)},p(b,[_]){_&1&&fe(n,"box-shadow",b[0]?"0 0 8px rgba(34, 197, 94, 0.8)":"none"),_&1&&H(n,"bg-green-500",b[0]),_&1&&H(n,"bg-gray-700",!b[0]),_&2&&fe(c,"box-shadow",b[1]?"0 0 8px rgba(59, 130, 246, 0.8)":"none"),_&2&&H(c,"bg-blue-500",b[1]),_&2&&H(c,"bg-gray-700",!b[1])},i:He,o:He,d(b){b&&L(e)}}}function yr(r,e,t){let n,s;return ct(r,Rt,i=>t(0,n=i)),ct(r,It,i=>t(1,s=i)),[n,s]}class br extends Ve{constructor(e){super(),Ke(this,e,yr,wr,Xe,{})}}let Ct,Dt;{let r=new URLSearchParams("?"+window.location.hash.substr(1));Ct=r.get("authKey")||void 0,Dt=r.get("controlUrl")||void 0}let Tt=null;new Promise((r,e)=>{Tt=r});let Ot=U("DISCONNECTED"),_r=U(!1);function vr(r){Ot.set("LOGINREADY"),Tt(r)}function Sr(r){switch(r){case 6:{Ot.set("CONNECTED");break}}}function xr(r){r.self.addresses[0];for(var e=!1,t=0;t<r.peers.length;t++)if(r.peers[t].exitNode){e=!0;break}e&&_r.set(!0)}const Er={authKey:Ct,controlUrl:Dt,loginUrlCb:vr,stateUpdateCb:Sr,netmapUpdateCb:xr},Lt="\x1B[1;35m",Bt="\x1B[0m",kr=[],Ar=[Lt+"CheerpX could not start"+Bt,"","Check the DevTools console for more information","","CheerpX is expected to work with recent desktop versions of Chrome, Edge, Firefox and Safari","","Give it a try from a desktop version / another browser!","","CheerpX internal error message is:",""],Pr=[Lt+"WebVM encountered an unexpected error"+Bt,"","Check the DevTools console for further information","","Please consider reporting a bug!","","CheerpX internal error message is:",""];function ve(r){self.plausible&&plausible(r)}const Y="0.33.1";let lt=!1,le,Nt,qe,Ut,jt,Wt;function Mr(r,e={auto:!1}){if(lt)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${r.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(le)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${r.kind}'\` after \`import '@anthropic-ai/sdk/shims/${le}'\``);lt=e.auto,le=r.kind,Nt=r.fetch,qe=r.File,Ut=r.ReadableStream,jt=r.getDefaultAgent,Wt=r.fileFromPath}class Rr{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Ir({manuallyImported:r}={}){const e=r?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let t,n,s,i;try{t=fetch,n=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new Rr(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:a=>!1}}le||Mr(Ir(),{auto:!0});class g extends Error{}class k extends g{constructor(e,t,n,s){super(`${k.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.request_id=s?.["request-id"],this.error=t}static makeMessage(e,t,n){const s=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new Ee({message:n,cause:Fe(t)});const i=t;return e===400?new qt(e,i,n,s):e===401?new Ft(e,i,n,s):e===403?new $t(e,i,n,s):e===404?new Xt(e,i,n,s):e===409?new Vt(e,i,n,s):e===422?new Kt(e,i,n,s):e===429?new zt(e,i,n,s):e>=500?new Jt(e,i,n,s):new k(e,i,n,s)}}class J extends k{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Ee extends k{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Ht extends Ee{constructor({message:e}={}){super({message:e??"Request timed out."})}}class qt extends k{}class Ft extends k{}class $t extends k{}class Xt extends k{}class Vt extends k{}class Kt extends k{}class zt extends k{}class Jt extends k{}class ${constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=$.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split($.NEWLINE_REGEXP);return n&&s.pop(),s.length===1&&!n?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),n||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new g(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new g(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new g("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}$.NEWLINE_CHARS=new Set([`
`,"\r"]);$.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class F{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const a of Cr(e,t)){if(a.event==="completion")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event==="message_start"||a.event==="message_delta"||a.event==="message_stop"||a.event==="content_block_start"||a.event==="content_block_delta"||a.event==="content_block_stop")try{yield JSON.parse(a.data)}catch(o){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),o}if(a.event!=="ping"&&a.event==="error")throw k.generate(void 0,`SSE Error: ${a.data}`,a.data,Zt(e.headers))}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new F(s,t)}static fromReadableStream(e,t){let n=!1;async function*s(){const a=new $,o=Je(e);for await(const f of o)for(const c of a.decode(f))yield c;for(const f of a.flush())yield f}async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new F(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=n.next();e.push(a),t.push(a)}return i.shift()}});return[new F(()=>s(e),this.controller),new F(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new Ut({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await t.next();if(a)return s.close();const o=n.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){await t.return?.()}})}}async function*Cr(r,e){if(!r.body)throw e.abort(),new g("Attempted to iterate over a response with no body");const t=new Or,n=new $,s=Je(r.body);for await(const i of Dr(s))for(const a of n.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of n.flush()){const a=t.decode(i);a&&(yield a)}}async function*Dr(r){let e=new Uint8Array;for await(const t of r){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let i;for(;(i=Tr(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function Tr(r){for(let n=0;n<r.length-2;n++){if(r[n]===10&&r[n+1]===10||r[n]===13&&r[n+1]===13)return n+2;if(r[n]===13&&r[n+1]===10&&n+3<r.length&&r[n+2]===13&&r[n+3]===10)return n+4}return-1}class Or{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=Lr(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function Lr(r,e){const t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}function Je(r){if(r[Symbol.asyncIterator])return r;const e=r.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Br=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",Nr=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&ke(r),ke=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function";async function Ur(r,e,t){if(r=await r,Nr(r))return r;if(Br(r)){const s=await r.blob();e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=ke(s)?[await s.arrayBuffer()]:[s];return new qe(i,e,t)}const n=await jr(r);if(e||(e=Hr(r)??"unknown_file"),!t?.type){const s=n[0]?.type;typeof s=="string"&&(t={...t,type:s})}return new qe(n,e,t)}async function jr(r){let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(ke(r))e.push(await r.arrayBuffer());else if(qr(r))for await(const t of r)e.push(t);else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${r?.constructor?.name}; props: ${Wr(r)}`);return e}function Wr(r){return`[${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}function Hr(r){return Te(r.name)||Te(r.filename)||Te(r.path)?.split(/[\\/]/).pop()}const Te=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},qr=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",ut=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody";var Gt={},Fr=function(r,e,t,n,s){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t},$r=function(r,e,t,n){if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},pe;async function Qt(r){const{response:e}=r;if(r.options.stream)return ee("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):F.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;const t=e.headers.get("content-type");if(t?.includes("application/json")||t?.includes("application/vnd.api+json")){const i=await e.json();return ee("response",e.status,e.url,e.headers,i),Yt(i,e)}const s=await e.text();return ee("response",e.status,e.url,e.headers,s),s}function Yt(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("request-id"),enumerable:!1})}class Ae extends Promise{constructor(e,t=Qt){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Ae(this.responsePromise,async t=>Yt(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Xr{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Oe("maxRetries",t),this.timeout=Oe("timeout",n),this.httpAgent=s,this.fetch=i??Nt}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Qr(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${rn()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async s=>{const i=s&&ke(s?.body)?new DataView(await s.body.arrayBuffer()):s?.body instanceof DataView?s.body:s?.body instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s?.body)?new DataView(s.body.buffer):s?.body;return{method:e,path:t,...s,body:i}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const{method:n,path:s,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:ut(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,f=this.calculateContentLength(o),c=this.buildURL(s,i);"timeout"in e&&Oe("timeout",e.timeout);const h=e.timeout??this.timeout,p=e.httpAgent??this.httpAgent??jt(c),S=h+1e3;typeof p?.options?.timeout=="number"&&S>(p.options.timeout??0)&&(p.options.timeout=S),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const b=this.buildHeaders({options:e,headers:a,contentLength:f,retryCount:t});return{req:{method:n,...o&&{body:o},headers:b,...p&&{agent:p},signal:e.signal??null},url:c,timeout:h}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:s}){const i={};n&&(i["content-length"]=n);const a=this.defaultHeaders(e);return pt(i,a),pt(i,t),ut(e.body)&&le!=="node"&&delete i["content-type"],mt(a,"x-stainless-retry-count")===void 0&&mt(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,s){return k.generate(e,t,n,s)}request(e,t=null){return new Ae(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e,s=n.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(n);const{req:i,url:a,timeout:o}=this.buildRequest(n,{retryCount:s-t});if(await this.prepareRequest(i,{url:a,options:n}),ee("request",a,n,i.headers),n.signal?.aborted)throw new J;const f=new AbortController,c=await this.fetchWithTimeout(a,i,o,f).catch(Fe);if(c instanceof Error){if(n.signal?.aborted)throw new J;if(t)return this.retryRequest(n,t);throw c.name==="AbortError"?new Ht:new Ee({cause:c})}const h=Zt(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const O=`retrying, ${t} attempts remaining`;return ee(`response (error; ${O})`,c.status,a,h),this.retryRequest(n,t,h)}const p=await c.text().catch(O=>Fe(O).message),S=Yr(p),b=S?void 0:p;throw ee(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,h,b),this.makeStatusError(c.status,S,b,h)}return{response:c,options:n,controller:f}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new Kr(this,n,e)}buildURL(e,t){const n=en(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Se(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new g(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,s){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),n);return this.fetch.call(void 0,e,{signal:s.signal,...a}).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let s;const i=n?.["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=n?.["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await tn(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Y}`}}class Vr{constructor(e,t,n,s){pe.set(this,void 0),Fr(this,pe,e),this.options=s,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new g("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,i]of n)e.url.searchParams.set(s,i);t.query=void 0,t.path=e.url.toString()}return await $r(this,pe,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(pe=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class Kr extends Ae{constructor(e,t,n){super(t,async s=>new n(e,s.response,await Qt(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const Zt=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),zr={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},G=r=>typeof r=="object"&&r!==null&&!Se(r)&&Object.keys(r).every(e=>er(zr,e)),Jr=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Y,"X-Stainless-OS":ft(Deno.build.os),"X-Stainless-Arch":dt(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Y,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Y,"X-Stainless-OS":ft(process.platform),"X-Stainless-Arch":dt(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const r=Gr();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Y,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Y,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Gr(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of r){const n=t.exec(navigator.userAgent);if(n){const s=n[1]||0,i=n[2]||0,a=n[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const dt=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",ft=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let ht;const Qr=()=>ht??(ht=Jr()),Yr=r=>{try{return JSON.parse(r)}catch{return}},Zr=/^[a-z][a-z0-9+.-]*:/i,en=r=>Zr.test(r),tn=r=>new Promise(e=>setTimeout(e,r)),Oe=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new g(`${r} must be an integer`);if(e<0)throw new g(`${r} must be a positive integer`);return e},Fe=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null)try{return new Error(JSON.stringify(r))}catch{}return new Error(String(r))},Le=r=>{if(typeof process<"u")return Gt?.[r]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(r)?.trim()};function Se(r){if(!r)return!0;for(const e in r)return!1;return!0}function er(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function pt(r,e){for(const t in e){if(!er(e,t))continue;const n=t.toLowerCase();if(!n)continue;const s=e[t];s===null?delete r[n]:s!==void 0&&(r[n]=s)}}function ee(r,...e){typeof process<"u"&&Gt?.DEBUG==="true"&&console.log(`Anthropic:DEBUG:${r}`,...e)}const rn=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),nn=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",sn=r=>typeof r?.get=="function",mt=(r,e)=>{const t=e.toLowerCase();if(sn(r)){const n=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(s,i,a)=>i+a.toUpperCase());for(const s of[e,t,e.toUpperCase(),n]){const i=r.get(s);if(i)return i}}for(const[n,s]of Object.entries(r))if(n.toLowerCase()===t)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${e} header, using the first entry.`),s[0]):s};let Pe=class extends Vr{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[],this.has_more=n.has_more||!1,this.first_id=n.first_id||null,this.last_id=n.last_id||null}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){if(this.options.query?.before_id){const t=this.first_id;return t?{params:{before_id:t}}:null}const e=this.last_id;return e?{params:{after_id:e}}:null}};class X{constructor(e){this._client=e}}let Ge=class extends X{retrieve(e,t){return this._client.get(`/v1/models/${e}?beta=true`,t)}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/v1/models?beta=true",Qe,{query:e,...t})}};class Qe extends Pe{}Ge.BetaModelInfosPage=Qe;class Me{constructor(e,t){this.iterator=e,this.controller=t}async*decoder(){const e=new $;for await(const t of this.iterator)for(const n of e.decode(t))yield JSON.parse(n);for(const t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),new g("Attempted to iterate over a response with no body");return new Me(Je(e.body),t)}}let Ye=class extends X{create(e,t){const{betas:n,...s}=e;return this._client.post("/v1/messages/batches?beta=true",{body:s,...t,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...t?.headers}})}retrieve(e,t={},n){if(G(t))return this.retrieve(e,{},t);const{betas:s}=t;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...n,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}list(e={},t){if(G(e))return this.list({},e);const{betas:n,...s}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",Ze,{query:s,...t,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...t?.headers}})}cancel(e,t={},n){if(G(t))return this.cancel(e,{},t);const{betas:s}=t;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...n,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}async results(e,t={},n){if(G(t))return this.results(e,{},t);const s=await this.retrieve(e);if(!s.results_url)throw new g(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);const{betas:i}=t;return this._client.get(s.results_url,{...n,headers:{"anthropic-beta":[...i??[],"message-batches-2024-09-24"].toString(),...n?.headers},__binaryResponse:!0})._thenUnwrap((a,o)=>Me.fromResponse(o.response,o.controller))}};class Ze extends Pe{}Ye.BetaMessageBatchesPage=Ze;let Re=class extends X{constructor(){super(...arguments),this.batches=new Ye(this._client)}create(e,t){const{betas:n,...s}=e;return this._client.post("/v1/messages?beta=true",{body:s,timeout:this._client._options.timeout??6e5,...t,headers:{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0,...t?.headers},stream:e.stream??!1})}countTokens(e,t){const{betas:n,...s}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:s,...t,headers:{"anthropic-beta":[...n??[],"token-counting-2024-11-01"].toString(),...t?.headers}})}};Re.Batches=Ye;Re.BetaMessageBatchesPage=Ze;class ue extends X{constructor(){super(...arguments),this.models=new Ge(this._client),this.messages=new Re(this._client)}}ue.Models=Ge;ue.BetaModelInfosPage=Qe;ue.Messages=Re;class tr extends X{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}}class et extends X{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/v1/messages/batches/${e}`,t)}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/v1/messages/batches",tt,{query:e,...t})}cancel(e,t){return this._client.post(`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){const n=await this.retrieve(e);if(!n.results_url)throw new g(`No batch \`results_url\`; Has it finished processing? ${n.processing_status} - ${n.id}`);return this._client.get(n.results_url,{...t,__binaryResponse:!0})._thenUnwrap((s,i)=>Me.fromResponse(i.response,i.controller))}}class tt extends Pe{}et.MessageBatchesPage=tt;const an=r=>{let e=0,t=[];for(;e<r.length;){let n=r[e];if(n==="\\"){e++;continue}if(n==="{"){t.push({type:"brace",value:"{"}),e++;continue}if(n==="}"){t.push({type:"brace",value:"}"}),e++;continue}if(n==="["){t.push({type:"paren",value:"["}),e++;continue}if(n==="]"){t.push({type:"paren",value:"]"}),e++;continue}if(n===":"){t.push({type:"separator",value:":"}),e++;continue}if(n===","){t.push({type:"delimiter",value:","}),e++;continue}if(n==='"'){let o="",f=!1;for(n=r[++e];n!=='"';){if(e===r.length){f=!0;break}if(n==="\\"){if(e++,e===r.length){f=!0;break}o+=n+r[e],n=r[++e]}else o+=n,n=r[++e]}n=r[++e],f||t.push({type:"string",value:o});continue}if(n&&/\s/.test(n)){e++;continue}let i=/[0-9]/;if(n&&i.test(n)||n==="-"||n==="."){let o="";for(n==="-"&&(o+=n,n=r[++e]);n&&i.test(n)||n===".";)o+=n,n=r[++e];t.push({type:"number",value:o});continue}let a=/[a-z]/i;if(n&&a.test(n)){let o="";for(;n&&a.test(n)&&e!==r.length;)o+=n,n=r[++e];if(o=="true"||o=="false"||o==="null")t.push({type:"name",value:o});else{e++;continue}continue}e++}return t},Z=r=>{if(r.length===0)return r;let e=r[r.length-1];switch(e.type){case"separator":return r=r.slice(0,r.length-1),Z(r);case"number":let t=e.value[e.value.length-1];if(t==="."||t==="-")return r=r.slice(0,r.length-1),Z(r);case"string":let n=r[r.length-2];if(n?.type==="delimiter")return r=r.slice(0,r.length-1),Z(r);if(n?.type==="brace"&&n.value==="{")return r=r.slice(0,r.length-1),Z(r);break;case"delimiter":return r=r.slice(0,r.length-1),Z(r)}return r},on=r=>{let e=[];return r.map(t=>{t.type==="brace"&&(t.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),t.type==="paren"&&(t.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(t=>{t==="}"?r.push({type:"brace",value:"}"}):t==="]"&&r.push({type:"paren",value:"]"})}),r},cn=r=>{let e="";return r.map(t=>{switch(t.type){case"string":e+='"'+t.value+'"';break;default:e+=t.value;break}}),e},ln=r=>JSON.parse(cn(on(Z(an(r)))));var M=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},d=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},I,q,me,ge,ne,se,we,ie,N,ae,ye,be,Q,Be,gt,Ne,Ue,je,We,wt;const yt="__json_buf";class xe{constructor(){I.add(this),this.messages=[],this.receivedMessages=[],q.set(this,void 0),this.controller=new AbortController,me.set(this,void 0),ge.set(this,()=>{}),ne.set(this,()=>{}),se.set(this,void 0),we.set(this,()=>{}),ie.set(this,()=>{}),N.set(this,{}),ae.set(this,!1),ye.set(this,!1),be.set(this,!1),Q.set(this,!1),Ne.set(this,e=>{if(M(this,ye,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new J),e instanceof J)return M(this,be,!0,"f"),this._emit("abort",e);if(e instanceof g)return this._emit("error",e);if(e instanceof Error){const t=new g(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new g(String(e)))}),M(this,me,new Promise((e,t)=>{M(this,ge,e,"f"),M(this,ne,t,"f")}),"f"),M(this,se,new Promise((e,t)=>{M(this,we,e,"f"),M(this,ie,t,"f")}),"f"),d(this,me,"f").catch(()=>{}),d(this,se,"f").catch(()=>{})}static fromReadableStream(e){const t=new xe;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,n){const s=new xe;for(const i of t.messages)s._addMessageParam(i);return s._run(()=>s._createMessage(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),s}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},d(this,Ne,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),d(this,I,"m",Ue).call(this);const i=await e.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const a of i)d(this,I,"m",je).call(this,a);if(i.controller.signal?.aborted)throw new J;d(this,I,"m",We).call(this)}_connected(){this.ended||(d(this,ge,"f").call(this),this._emit("connect"))}get ended(){return d(this,ae,"f")}get errored(){return d(this,ye,"f")}get aborted(){return d(this,be,"f")}abort(){this.controller.abort()}on(e,t){return(d(this,N,"f")[e]||(d(this,N,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=d(this,N,"f")[e];if(!n)return this;const s=n.findIndex(i=>i.listener===t);return s>=0&&n.splice(s,1),this}once(e,t){return(d(this,N,"f")[e]||(d(this,N,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{M(this,Q,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){M(this,Q,!0,"f"),await d(this,se,"f")}get currentMessage(){return d(this,q,"f")}async finalMessage(){return await this.done(),d(this,I,"m",Be).call(this)}async finalText(){return await this.done(),d(this,I,"m",gt).call(this)}_emit(e,...t){if(d(this,ae,"f"))return;e==="end"&&(M(this,ae,!0,"f"),d(this,we,"f").call(this));const n=d(this,N,"f")[e];if(n&&(d(this,N,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!d(this,Q,"f")&&!n?.length&&Promise.reject(s),d(this,ne,"f").call(this,s),d(this,ie,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!d(this,Q,"f")&&!n?.length&&Promise.reject(s),d(this,ne,"f").call(this,s),d(this,ie,"f").call(this,s),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",d(this,I,"m",Be).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),d(this,I,"m",Ue).call(this),this._connected();const s=F.fromReadableStream(e,this.controller);for await(const i of s)d(this,I,"m",je).call(this,i);if(s.controller.signal?.aborted)throw new J;d(this,I,"m",We).call(this)}[(q=new WeakMap,me=new WeakMap,ge=new WeakMap,ne=new WeakMap,se=new WeakMap,we=new WeakMap,ie=new WeakMap,N=new WeakMap,ae=new WeakMap,ye=new WeakMap,be=new WeakMap,Q=new WeakMap,Ne=new WeakMap,I=new WeakSet,Be=function(){if(this.receivedMessages.length===0)throw new g("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},gt=function(){if(this.receivedMessages.length===0)throw new g("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter(n=>n.type==="text").map(n=>n.text);if(t.length===0)throw new g("stream ended without producing a content block with type=text");return t.join(" ")},Ue=function(){this.ended||M(this,q,void 0,"f")},je=function(t){if(this.ended)return;const n=d(this,I,"m",wt).call(this,t);switch(this._emit("streamEvent",t,n),t.type){case"content_block_delta":{const s=n.content.at(-1);t.delta.type==="text_delta"&&s.type==="text"?this._emit("text",t.delta.text,s.text||""):t.delta.type==="input_json_delta"&&s.type==="tool_use"&&s.input&&this._emit("inputJson",t.delta.partial_json,s.input);break}case"message_stop":{this._addMessageParam(n),this._addMessage(n,!0);break}case"content_block_stop":{this._emit("contentBlock",n.content.at(-1));break}case"message_start":{M(this,q,n,"f");break}}},We=function(){if(this.ended)throw new g("stream has ended, this shouldn't happen");const t=d(this,q,"f");if(!t)throw new g("request ended without sending any chunks");return M(this,q,void 0,"f"),t},wt=function(t){let n=d(this,q,"f");if(t.type==="message_start"){if(n)throw new g(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!n)throw new g(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":return n;case"message_delta":return n.stop_reason=t.delta.stop_reason,n.stop_sequence=t.delta.stop_sequence,n.usage.output_tokens=t.usage.output_tokens,n;case"content_block_start":return n.content.push(t.content_block),n;case"content_block_delta":{const s=n.content.at(t.index);if(s?.type==="text"&&t.delta.type==="text_delta")s.text+=t.delta.text;else if(s?.type==="tool_use"&&t.delta.type==="input_json_delta"){let i=s[yt]||"";i+=t.delta.partial_json,Object.defineProperty(s,yt,{value:i,enumerable:!1,writable:!0}),i&&(s.input=ln(i))}return n}case"content_block_stop":return n}},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("streamEvent",s=>{const i=t.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{n=!0;for(const i of t)i.reject(s);t.length=0}),this.on("error",s=>{n=!0;for(const i of t)i.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new F(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class Ie extends X{constructor(){super(...arguments),this.batches=new et(this._client)}create(e,t){return e.model in bt&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${bt[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}stream(e,t){return xe.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}const bt={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024"};Ie.Batches=et;Ie.MessageBatchesPage=tt;class rt extends X{retrieve(e,t){return this._client.get(`/v1/models/${e}`,t)}list(e={},t){return G(e)?this.list({},e):this._client.getAPIList("/v1/models",nt,{query:e,...t})}}class nt extends Pe{}rt.ModelInfosPage=nt;var rr;class m extends Xr{constructor({baseURL:e=Le("ANTHROPIC_BASE_URL"),apiKey:t=Le("ANTHROPIC_API_KEY")??null,authToken:n=Le("ANTHROPIC_AUTH_TOKEN")??null,...s}={}){const i={apiKey:t,authToken:n,...s,baseURL:e||"https://api.anthropic.com"};if(!i.dangerouslyAllowBrowser&&nn())throw new g(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new tr(this),this.messages=new Ie(this),this.models=new rt(this),this.beta=new ue(this),this._options=i,this.apiKey=t,this.authToken=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if(!(this.apiKey&&e["x-api-key"])&&t["x-api-key"]!==null&&!(this.authToken&&e.authorization)&&t.authorization!==null)throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const t=this.apiKeyAuth(e),n=this.bearerAuth(e);return t!=null&&!Se(t)?t:n!=null&&!Se(n)?n:{}}apiKeyAuth(e){return this.apiKey==null?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return this.authToken==null?{}:{Authorization:`Bearer ${this.authToken}`}}}rr=m;m.Anthropic=rr;m.HUMAN_PROMPT=`

Human:`;m.AI_PROMPT=`

Assistant:`;m.DEFAULT_TIMEOUT=6e5;m.AnthropicError=g;m.APIError=k;m.APIConnectionError=Ee;m.APIConnectionTimeoutError=Ht;m.APIUserAbortError=J;m.NotFoundError=Xt;m.ConflictError=Vt;m.RateLimitError=zt;m.BadRequestError=qt;m.AuthenticationError=Ft;m.InternalServerError=Jt;m.PermissionDeniedError=$t;m.UnprocessableEntityError=Kt;m.toFile=Ur;m.fileFromPath=Wt;m.Completions=tr;m.Messages=Ie;m.Models=rt;m.ModelInfosPage=nt;m.Beta=ue;const{HUMAN_PROMPT:Hn,AI_PROMPT:qn}=m;var $e=[];function un(r){new m({apiKey:r,dangerouslyAllowBrowser:!0}),$e=[],hn.set($e),localStorage.setItem("anthropic-api-key",r),fn.set("READY"),ve("ClaudeAI Key")}function dn(){var r=localStorage.getItem("anthropic-api-key");r&&un(r)}const fn=U("KEY_REQUIRED"),hn=U($e),pn=U(null);dn();function _t(r){let e,t='<canvas class="w-full h-full cursor-none" id="display"></canvas>';return{c(){e=T("div"),e.innerHTML=t,this.h()},l(n){e=D(n,"DIV",{class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-1u2kqrk"&&(e.innerHTML=t),this.h()},h(){C(e,"class","absolute top-0 bottom-0 left-0 right-0")},m(n,s){ze(n,e,s)},d(n){n&&L(e)}}}function mn(r){let e,t,n,s,i,a,o="",f;t=new br({});let c=r[0].needsDisplay&&_t();return{c(){e=T("main"),Mt(t.$$.fragment),n=ce(),s=T("div"),c&&c.c(),i=ce(),a=T("div"),a.innerHTML=o,this.h()},l(h){e=D(h,"MAIN",{class:!0});var p=z(e);Pt(t.$$.fragment,p),n=oe(p),s=D(p,"DIV",{class:!0});var S=z(s);c&&c.l(S),i=oe(S),a=D(S,"DIV",{class:!0,id:!0,"data-svelte-h":!0}),_e(a)!=="svelte-a2s02y"&&(a.innerHTML=o),S.forEach(L),p.forEach(L),this.h()},h(){C(a,"class","absolute top-0 bottom-0 left-0 right-0 p-1 scrollbar"),C(a,"id","console"),C(s,"class","absolute top-0 bottom-0 left-0 right-0"),C(e,"class","relative w-full h-full")},m(h,p){ze(h,e,p),At(t,e,null),R(e,n),R(e,s),c&&c.m(s,null),R(s,i),R(s,a),f=!0},p(h,[p]){h[0].needsDisplay?c||(c=_t(),c.c(),c.m(s,i)):c&&(c.d(1),c=null)},i(h){f||(kt(t.$$.fragment,h),f=!0)},o(h){Et(t.$$.fragment,h),f=!1},d(h){h&&L(e),xt(t),c&&c.d()}}}function vt(r,e,t){for(;r.length>1&&r[1].t<t;)r.shift()}function St(){return parseInt(getComputedStyle(document.body).fontSize)}function gn(r,e,t){let{configObj:n=null}=e,{processCallback:s=null}=e,{cacheId:i=null}=e,{cpuActivityEvents:a=[]}=e,{diskLatencies:o=[]}=e,{activityEventsInterval:f=0}=e;var c=null,h=null,p=null,S=null,b=null,_=0,j=0;typeof window<"u"&&!window.__webvm_rpc&&(window.__webvm_rpc=null);function O(l,u){if(u!=1)return;const w=new Uint8Array(l);if(c.write(w),window.__webvm_rpc&&window.__webvm_rpc.active)try{const E=window.__webvm_rpc.decoder.decode(w);window.__webvm_rpc.buffer+=E;const v=window.__webvm_rpc.marker;if(v&&window.__webvm_rpc.buffer.includes(v)){const A=window.__webvm_rpc.buffer.split(v)[0],y=window.__webvm_rpc.id;window.__webvm_rpc.active=!1,window.__webvm_rpc.buffer="",window.__webvm_rpc.marker="",window.parent&&window.parent.postMessage({type:"webvm:result",id:y,result:{ok:!0,output:A}},"*")}}catch{}}function V(l){if(S!=null)for(var u=0;u<l.length;u++)S(l.charCodeAt(u))}function te(l){for(var u=0;u<l.length;u++)c.write(l[u]+`
`)}function nr(){var l=Date.now(),u=l-1e4;vt(a,l,u),st(l,u),a.length==0&&(clearInterval(f),t(1,f=0))}function st(l,u){for(var w=0,E=u,v=!1,A=0;A<a.length;A++){var y=a[A],x=y.t;x<u&&(x=u),y.state=="ready"?(w+=x-E,v=!1):(E=x,v=!0)}v&&(w+=l-E),mr.set(Math.ceil(w/1e4*100))}function sr(l){It.set(l!="ready")}function ir(l){o.push(l),o.length>30&&o.shift();for(var u=0,w=0;w<o.length;w++)u+=o[w];var E=u/o.length;gr.set(Math.ceil(E))}function ar(l){Rt.set(l!="ready");var u=Date.now(),w=u-1e4;vt(a,u,w),a.push({t:u,state:l}),st(u,w),f!=0&&clearInterval(f),t(1,f=setInterval(nr,2e3))}function it(l){var u=1,w=l.offsetWidth,E=l.offsetHeight,v=1024,A=768;w<v&&(u=v/w),E<A&&(u=Math.max(u,A/E));var y=Math.floor(w*u),x=Math.floor(E*u);h.setKmsCanvas(l,y,x);var B=1,W=1024,P=768;y>W&&(B=W/y),x>P&&(B=Math.min(B,P/x));var K=Math.floor(y*B),re=Math.floor(x*B);pn.set({width:K,height:re,mouseMult:u*B})}var Ce=0,De=0;function or(){Ce==window.innerWidth&&De==window.innerHeight||(Ce=window.innerWidth,De=window.innerHeight,cr())}function cr(){c.options.fontSize=St(),p.fit();const l=document.getElementById("display");l&&it(l)}async function lr(){const{Terminal:l}=await he(async()=>{const{Terminal:y}=await import("../chunks/PglAAeey.js").then(x=>x.x);return{Terminal:y}},[],import.meta.url),{FitAddon:u}=await he(async()=>{const{FitAddon:y}=await import("../chunks/CyyJcX4C.js").then(x=>x.a);return{FitAddon:y}},[],import.meta.url),{WebLinksAddon:w}=await he(async()=>{const{WebLinksAddon:y}=await import("../chunks/B1M8nFkN.js").then(x=>x.a);return{WebLinksAddon:y}},[],import.meta.url);c=new l({cursorBlink:!0,convertEol:!0,fontFamily:"monospace",fontWeight:400,fontWeightBold:700,fontSize:St()}),p=new u,c.loadAddon(p);var E=new w;c.loadAddon(E);const v=document.getElementById("console");c.open(v),c.scrollToTop(),p.fit(),window.addEventListener("resize",or),c.focus(),c.onData(V);function A(y){y.preventDefault(),y.stopPropagation()}v.addEventListener("dragover",A,!1),v.addEventListener("dragenter",A,!1),v.addEventListener("dragleave",A,!1),v.addEventListener("drop",A,!1),Ce=window.innerWidth,De=window.innerHeight,n.printIntro&&te(kr);try{await fr()}catch(y){te(Pr),te([y.toString()]);return}}function ur(l){if(j==l||(j=l,l!=7))return;const u=document.getElementById("display");u.parentElement.style.zIndex=5,ve("Display activated")}function dr(){_++,s&&s(_)}async function fr(){const l=await he(()=>import("../chunks/BhrQU2s-.js"),[],import.meta.url);var u=null;switch(n.diskImageType){case"cloud":try{u=await l.CloudDevice.create(n.diskImageUrl)}catch(W){var w="wss:";if(n.diskImageUrl.startsWith(w))ve("WS Disk failure"),u=await l.CloudDevice.create("https:"+n.diskImageUrl.substr(w.length));else throw W}break;case"bytes":u=await l.HttpBytesDevice.create(n.diskImageUrl);break;case"github":u=await l.GitHubDevice.create(n.diskImageUrl);break;default:throw new Error("Unrecognized device type")}b=await l.IDBDevice.create(i);var E=await l.OverlayDevice.create(u,b),v=await l.WebDevice.create(""),A=await l.WebDevice.create("documents"),y=await l.DataDevice.create(),x=[{type:"ext2",dev:E,path:"/"},{type:"dir",dev:v,path:"/web"},{type:"dir",dev:y,path:"/data"},{type:"devs",path:"/dev"},{type:"devpts",path:"/dev/pts"},{type:"proc",path:"/proc"},{type:"sys",path:"/sys"},{type:"dir",dev:A,path:"/home/user/documents"}];try{h=await l.Linux.create({mounts:x,networkInterface:Er})}catch(W){te(Ar),te([W.toString()]);return}h.registerCallback("cpuActivity",ar),h.registerCallback("diskActivity",sr),h.registerCallback("diskLatency",ir),h.registerCallback("processCreated",dr),c.scrollToBottom(),S=h.setCustomConsole(O,c.cols,c.rows),window.__webvm_rpc={active:!1,id:"",marker:"",buffer:"",decoder:new TextDecoder},window.addEventListener("message",async W=>{const P=W.data;if(!P||typeof P!="object"||!P.type||!P.id)return;if(window.__webvm_rpc.active){window.parent&&window.parent.postMessage({type:"webvm:error",id:P.id,error:"WebVM busy"},"*");return}const K=P.id;if(P.type==="webvm:exec"){const re=P.cmd||"",de=`__WEBVM_DONE_${K}__`;window.__webvm_rpc.active=!0,window.__webvm_rpc.id=K,window.__webvm_rpc.marker=de,window.__webvm_rpc.buffer="",V(re+`
`),V("echo "+de+`
`);return}if(P.type==="webvm:writeFile"){const re=P.path||"",de=P.content||"",at=`__WEBVM_DONE_${K}__`;window.__webvm_rpc.active=!0,window.__webvm_rpc.id=K,window.__webvm_rpc.marker=at,window.__webvm_rpc.buffer="";const ot=`__WEBVM_EOF_${K}__`;V(`cat > ${re} <<'${ot}'
`),V(de+`
`),V(`${ot}
`),V("echo "+at+`
`);return}}),window.parent&&window.parent.postMessage({type:"webvm:ready"},"*");const B=document.getElementById("display");for(B&&(it(B),h.setActivateConsole(ur));;)await h.run(n.cmd,n.args,n.opts)}return hr(lr),r.$$set=l=>{"configObj"in l&&t(0,n=l.configObj),"processCallback"in l&&t(2,s=l.processCallback),"cacheId"in l&&t(3,i=l.cacheId),"cpuActivityEvents"in l&&t(4,a=l.cpuActivityEvents),"diskLatencies"in l&&t(5,o=l.diskLatencies),"activityEventsInterval"in l&&t(1,f=l.activityEventsInterval)},[n,f,s,i,a,o]}class wn extends Ve{constructor(e){super(),Ke(this,e,gn,mn,Xe,{configObj:0,processCallback:2,cacheId:3,cpuActivityEvents:4,diskLatencies:5,activityEventsInterval:1})}}const yn="wss://disks.webvm.io/debian_large_20230522_5044875331_2.ext2",bn="cloud",_n=!0,vn=!1,Sn="/bin/bash",xn=["--login"],En={env:["HOME=/home/user","TERM=xterm","USER=user","SHELL=/bin/bash","EDITOR=vim","LANG=en_US.UTF-8","LC_ALL=C"],cwd:"/home/user",uid:1e3,gid:1e3},kn=Object.freeze(Object.defineProperty({__proto__:null,args:xn,cmd:Sn,diskImageType:bn,diskImageUrl:yn,needsDisplay:vn,opts:En,printIntro:_n},Symbol.toStringTag,{value:"Module"}));function An(r){let e,t;return e=new wn({props:{configObj:kn,processCallback:r[0],cacheId:"blocks_terminal"}}),{c(){Mt(e.$$.fragment)},l(n){Pt(e.$$.fragment,n)},m(n,s){At(e,n,s),t=!0},p:He,i(n){t||(kt(e.$$.fragment,n),t=!0)},o(n){Et(e.$$.fragment,n),t=!1},d(n){xt(e,n)}}}function Pn(r){function e(t){t<=5&&ve(`Process started: ${t}`)}return[e]}class Fn extends Ve{constructor(e){super(),Ke(this,e,Pn,An,Xe,{})}}export{Fn as component,Dn as universal};
